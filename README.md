Note: I never got this working due to lack of time, but it was a good try.
